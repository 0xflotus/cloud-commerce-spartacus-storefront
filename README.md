# Spartacus - Angular Storefront

---

## Minimum Requirements

```
Node.js >= 8.9.0
yarn >= 1.6.0
Read access to Artifactory (https://repository.hybris.com)
```

## Dependencies Configuration

This is a one time setup. We pull all of our dependencies from our internal npm registry (artifactory). In order for you to be able to do this, you need to do the following:

1.  Login to [artifactory](https://repository.hybris.com/webapp/#/login)
2.  Once you have login, there should be an `npm repository` link on the homepage, in the "Set Me Up" section. Click on it and a popup window with instructions will appear.
3.  Enter your password in the upper right. This will populate the commands with your encrypted password. This way you can copy and paste the commands directly in the terminal.
4.  Out of all the commands in the popup, you will only need to run the first one on your machine. It looks like:

```
$ curl -u[firstname.lastname@sap.com]:[encryptedpassword] https://repository.hybris.com/api/npm/auth
```

As instructed next, paste the result in your ~/.npmrc file (create the file if it doesn't exist)

The last step is to add this line to ~/.npmrc:

```
registry=https://repository.hybris.com/api/npm/npm-repository/
```

That's it. For a quick way to confirm your new config, you can run:

```
$ yarn config list
```

You should see your new ~/.npmrc configurations at the end of the list, in the `info npm config` section.

## Installation Steps

Install dependencies:

```
$ yarn install
```

Build the storefrontlib

```
ng build storefrontlib
```

Start the angular app.

```
$ yarn start
```

Then point your browser to http://localhost:4200/

---

## Development

The following topiocs outline some topics that improve the development experience.

### Proxy Backend

We provide a proxy configuration to allows development without a local Hybris Commerce installation.

There are 2 available configurations for the backend:

1.  Redirect backend calls to an external available commerce server
2.  Redirect backend calls to a local [json-server](https://github.com/typicode/json-serve)

The advantages of a proxied backend are:

- allows developers to build features without knowledge of setting up and running Hybris Commerce.
- more lightweight as we do not run an expensive server locally
- allows developers to build features that require a backend that's not yet (fully) ready
- we do not add any mock configuration of proxy configurations in the production code; only used during development.
- the proxy settings allows to work around CORS, so that devs don't need to worry about this.
- the mock data can be used for both read and other CRUD operations

The 2 different modes can be started with `yarn start:proxy` or `yarn start:mock`.

⚠️ The mock data is dynamically generated by the help of [faker.js](https://github.com/Marak/faker.js). The content is not yet finalized and needs to be completed and optimized.

### Library development

When developing library code, you have to rebuild the library each time you want to see and test your changes in the running app. The Anguar 6 docs give some explanations in [Why do I need to build the library everytime I make changes?](https://github.com/angular/angular-cli/wiki/stories-create-library#why-do-i-need-to-build-the-library-everytime-i-make-changes)

That being said, there is a way to configure the workspace so the lib code is buit like a standalone application, giving the developer the convenience of hot reloading changes.

**WARNING:** This configuration is optional and should only be used for convenience on local development environments. **It should never be commited back to git.**

Here is how it's done: In the tsconfig.json file at the root of the repo, change this:

```
    "paths": {
      "storefrontlib": [
        "dist/storefrontlib"
      ]
    }
```

And use this instead:

```
    "paths": {
      "storefrontlib": [
        "projects/storefrontlib/src/public_api"
      ]
    }
```

### Development tools

#### Code Editor: VS Code

This project is intended to be edited with [Microsoft Visial Studio Code](https://code.visualstudio.com)

##### VS Code Workspace Extensions

The development team relies on a few extensions for productivity and code compliance. When you open the source folder in vscode, if you are missing some of these recommended extensions, vscode will prompt you for installation. The list of recommended extensions is found in '.vscode/extensions.json'.

Please make sure you install them.

##### VS Code Workspace settings

These are vscode settings the team relies on. They are shared and enforced via vscode workspace settings. If you want to change something, propose the change don't just commit it, so the whole team uses it.

### Browser: Google Chrome

For development, Google Chrome is recommended. There is a "Debugger for Chrome" extension for vscode in the workspace extensions. This allows you to place breakpoint in typescript from vscode and debug the app from vscode.
Chrome also manages well security exceptions that are needed to get the application running in a development environment.

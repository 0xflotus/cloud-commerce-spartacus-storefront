<ng-container *ngIf="product$ | async as product">

    <ng-container *yInnerTemplate="innerTemplates.PAGE">
        <div class="container">
            <div class="y-product-details">
                <div class="row">
                    <div class="col-lg-7 d-none d-md-block">
                        <ng-container *yInnerTemplate="innerTemplates.IMAGES">
                            <y-product-images [product]="product"></y-product-images>
                        </ng-container>
                    </div>
                    <div class="col-lg-5">

                        <ng-container *yInnerTemplate="innerTemplates.TITLE">
                            <div class="y-product-details__item-name">{{product?.name}}</div>
                            <div class="y-product-details__item-code">ID {{product?.code}}</div>
                        </ng-container>

                        <ng-container *yInnerTemplate="innerTemplates.RATING">
                            <div class="y-product-details__item-rating">
                                <y-star-rating [rating]="product?.averageRating" [disabled]="true"></y-star-rating>
                                <div class="y-product-details__review-count">({{product?.numberOfReviews}})</div>
                                <a class="y-product-details__review-link btn-link" (click)="goToReviews($event)">Write
                                    a
                                    review</a>
                            </div>
                        </ng-container>

                        <div class="d-md-none">
                            <ng-container *yInnerTemplate="innerTemplates.IMAGES">
                                <y-product-images [product]="product"></y-product-images>
                            </ng-container>
                        </div>

                        <ng-container *yInnerTemplate="innerTemplates.SUMMARY">
                            <y-product-summary [product]="product" (itemCountChange)="itemCount = $event"></y-product-summary>
                        </ng-container>

                        <ng-container *yInnerTemplate="innerTemplates.ADDTOCART">
                            <y-add-to-cart *ngIf="product?.stock?.stockLevelStatus !=='outOfStock'" [quantity]="itemCount"
                                [productCode]="product?.code"></y-add-to-cart>
                        </ng-container>

                        <ng-container *yInnerTemplate="innerTemplates.SHARE">
                            <a href="#" class="btn-link">
                                Share
                            </a>
                        </ng-container>

                    </div>
                </div>
            </div>
        </div>



        <ng-container *yInnerTemplate="innerTemplates.TAB">
            <div class="y-product-details__tabset" #tabSetWrapper>
                <ngb-tabset justify="center" #tabSet>
                    <ngb-tab>
                        <ng-template ngbTabTitle>
                            <div class="y-product-details__tab-title">
                                Product Details
                            </div>
                        </ng-template>
                        <ng-template ngbTabContent>
                            <div class="y-product-details__tab-section">
                                <ng-container *yInnerTemplate="innerTemplates.DESCRIPTION">
                                    <p [innerHTML]="product?.description"></p>
                                </ng-container>
                            </div>
                        </ng-template>
                    </ngb-tab>
                    <ngb-tab>
                        <ng-template ngbTabTitle>
                            <div class="y-product-details__tab-title">
                                Specs
                            </div>
                        </ng-template>
                        <ng-template ngbTabContent>
                            <div class="y-product-details__tab-section">
                                <ng-container *yInnerTemplate="innerTemplates.SPECIFICATIONS">
                                    <y-product-attributes [product]="product"></y-product-attributes>
                                </ng-container>
                            </div>
                        </ng-template>
                    </ngb-tab>

                    <ngb-tab id="reviews">
                        <ng-template ngbTabTitle>
                            <div class="y-product-details__tab-title">
                                Reviews ({{product?.numberOfReviews}})
                            </div>
                        </ng-template>
                        <ng-template ngbTabContent>
                            <div class="y-product-details__tab-section">
                                <ng-container *yInnerTemplate="innerTemplates.REVIEWS">
                                    <y-product-reviews [(isWritingReview)]="isWritingReview" [product]="product"></y-product-reviews>
                                </ng-container>
                            </div>
                        </ng-template>
                    </ngb-tab>
                    <ngb-tab>
                        <ng-template ngbTabTitle>
                            <div class="y-product-details__tab-title">
                                Shipping
                            </div>
                        </ng-template>
                        <ng-template ngbTabContent>
                            <div class="y-product-details__tab-section">
                                <ng-container *yInnerTemplate="innerTemplates.SHIPPING">
                                    <ng-container yComponentWrapper componentType="CMSTabParagraphComponent"
                                        componentUid="deliveryTab" [componentLoad]="true"></ng-container>
                                </ng-container>
                                <y-dynamic-slot position="Tabs"></y-dynamic-slot>
                            </div>
                        </ng-template>
                    </ngb-tab>
                </ngb-tabset>
            </div>


            <!-- Mobile accordion -->
            <div class="y-product-details__tabset-mobile">
                <ngb-accordion #acc="ngbAccordion">
                    <ngb-panel id="toggle-1" title="Product Details">
                        <ng-template ngbPanelContent>
                            <ng-container *yInnerTemplate="innerTemplates.DESCRIPTION">
                                <p [innerHTML]="product?.description"></p>
                            </ng-container>
                        </ng-template>
                    </ngb-panel>
                    <ngb-panel id="toggle-2" title="Specs">
                        <ng-template ngbPanelContent>
                            <ng-container *yInnerTemplate="innerTemplates.SPECIFICATIONS">
                                <y-product-attributes [product]="product"></y-product-attributes>
                            </ng-container>
                        </ng-template>
                    </ngb-panel>
                    <ngb-panel id="toggle-3" title="Reviews">
                        <ng-template ngbPanelContent>
                            <ng-container *yInnerTemplate="innerTemplates.REVIEWS">
                                <y-product-reviews [(isWritingReview)]="isWritingReview" [product]="product"></y-product-reviews>
                            </ng-container>
                        </ng-template>
                    </ngb-panel>
                    <ngb-panel id="toggle-4" title="Shipping">
                        <ng-template ngbPanelContent>
                            <div class="y-product-details__tab-section">

                                <ng-container *yInnerTemplate="innerTemplates.SHIPPING">
                                    <!-- <y-component-wrapper [componentType]="'CMSTabParagraphComponent'" [componentUid]="'deliveryTab'"
                            [componentLoad]="true"></y-component-wrapper> -->
                                    <div yComponentWrapper componentType="CMSTabParagraphComponent" componentUid="deliveryTab"
                                        [componentLoad]="true"></div>
                                    <y-dynamic-slot position="Tabs"></y-dynamic-slot>
                                </ng-container>
                            </div>
                        </ng-template>
                    </ngb-panel>
                </ngb-accordion>
            </div>

        </ng-container>


    </ng-container>
</ng-container>

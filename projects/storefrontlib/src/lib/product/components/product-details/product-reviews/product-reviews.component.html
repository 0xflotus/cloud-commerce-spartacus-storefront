<div *ngIf="reviews$ | async as reviews">
    <mat-card *ngIf="!isWritingReview; else writeReview">

        <mat-card-title>Reviews for {{product?.name}}</mat-card-title>
        <mat-card-subtitle>
            <div class="reviewHeaderContainer">
                <div class="overallRatingContainer">
                    <h3>Overall Rating</h3>
                    <y-star-rating [rating]="product.averageRating" class="rating" [disabled]="true"></y-star-rating>
                </div>
                <div>
                    <button class="mat-raised-button mat-primary" (click)="initiateWriteReview()">Write a review</button>
                </div>
            </div>
        </mat-card-subtitle>

        <mat-card-content>

            <mat-list>
                <div *ngFor="let review of (reviews | slice:0:maxListItems)" class="review">
                    <mat-list-item>
                        <mat-icon mat-list-icon color="primary">rate_review</mat-icon>
                        <!--
                        <h4 matLine>"{{review.headline}}"</h4>
                        <p matLine>By {{review.principal.name}} on {{review.date | date}}</p>-->
                        <!--<button md-button (click)="onClick">
                            <y-star-rating [rating]="review.rating"></y-star-rating>
                        </button>-->
                        <span>{{review.headline}}</span>
                    </mat-list-item>
                    <div class="comment">
                        <y-star-rating [rating]="review.rating" class="rating" [disabled]="true"></y-star-rating>
                        <div>
                            {{review.comment}}
                        </div>
                        <div class="reviewerNameContainer">
                            <span>{{review.alias? review.alias : review.principal.name}}</span>
                        </div>
                    </div>
                </div>
            </mat-list>
        </mat-card-content>
        <mat-card-actions align="end">
            <a (click)="maxListItems = reviews.length" *ngIf="maxListItems === initialMaxListItems" mat-button>More</a>
            <a (click)="maxListItems = initialMaxListItems" *ngIf="maxListItems !== initialMaxListItems" mat-button>Less</a>
        </mat-card-actions>
    </mat-card>

    <ng-template #writeReview>
        <mat-card class="writeReviewContainer">
            <mat-card-title>Write a Review</mat-card-title>
            <form [formGroup]="reviewForm" (ngSubmit)="submitReview()">
                <div class="formControlContainer">
                    <span>Review Title *</span>
                    <input type="text" name="title" formControlName='title' />
                </div>
                <div class="formControlContainer">
                    <span>Write your comments *</span>
                    <textarea type="text" name="comment" formControlName='comment'></textarea>
                </div>
                <div class="formControlContainer">
                    <span>Rating *</span>
                    <y-star-rating formControlName='rating' [steps]="0.5"></y-star-rating>
                </div>
                <div class="formControlContainer">
                    <span>Reviewer name (optional)</span>
                    <input type="text" name="reviewerName" formControlName='reviewerName' />
                </div>
                <div>
                    <button class="mat-raised-button" type="button" (click)="cancelWriteReview()">Cancel</button>
                    <button class="mat-raised-button" [ngClass]="{'submitBtn': reviewForm.valid}" type="submit" [disabled]="!reviewForm.valid">submit</button>
                </div>
            </form>
        </mat-card>
    </ng-template>
    <!--<mat-card *ngFor="let review of reviews" class="review">
        <mat-card-header>
            <mat-icon mat-card-avatar>rate_review</mat-icon>
            <mat-card-title>"{{review.headline}}"</mat-card-title>
            <mat-card-subtitle>By {{review.principal.name}} on {{review.date | date}}</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
            {{review.comment}}
        </mat-card-content>
        <mat-card-actions align="end">
            <y-star-rating [rating]="review.rating"></y-star-rating>
        </mat-card-actions>
    </mat-card>-->


</div>